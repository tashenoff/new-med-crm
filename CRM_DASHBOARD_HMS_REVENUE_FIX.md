# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤—ã—Ä—É—á–∫–∞ –≤ –¥–∞—à–±–æ—Ä–¥–µ CRM - —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ HMS

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–í –¥–∞—à–±–æ—Ä–¥–µ CRM –≤ –∫–∞—Ä—Ç–æ—á–∫–µ "–ö–ª–∏–µ–Ω—Ç—ã" –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞—Å—å –Ω–µ—Ç–æ—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –∏–∑ CRM, –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ–ø–ª–∞—Ç –∏–∑ –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è HMS.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–°–æ–∑–¥–∞–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å HMS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã—Ä—É—á–∫–µ.

## üêõ –ù–∞–π–¥–µ–Ω–Ω–∞—è –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞
**–ü—Ä–æ–±–ª–µ–º–∞**: CRM API –∏—Å–∫–ª—é—á–∞–ª —á–µ—Ä–Ω–æ–≤–∏–∫–∏ –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è, –∏–∑-–∑–∞ —á–µ–≥–æ –ø–æ–∫–∞–∑—ã–≤–∞–ª 12,811‚Ç∏ –≤–º–µ—Å—Ç–æ 17,811‚Ç∏.
**–ü—Ä–∏—á–∏–Ω–∞**: –í —á–µ—Ä–Ω–æ–≤–∏–∫–∞—Ö –±—ã–ª–æ 5,000‚Ç∏ –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å.
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–µ–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –í–°–ï–• –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è (–∫–∞–∫ –≤ HMS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ).

### üõ†Ô∏è –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

#### 1. **–ù–æ–≤—ã–π API endpoint** (`backend/crm/routes/integration.py`)
```python
@integration_router.get("/hms-revenue-statistics")
async def get_hms_revenue_statistics(db):
    """–ü–æ–ª—É—á–∏—Ç—å –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã—Ä—É—á–∫–∏ –∏–∑ HMS –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞ CRM"""
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `total_revenue` - –æ–±—â–∞—è –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –∏–∑ –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è
- `total_amount` - –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—Å–µ—Ö –ø–ª–∞–Ω–æ–≤
- `pending_amount` - —Å—É–º–º–∞ –∫ –¥–æ–ø–ª–∞—Ç–µ
- `total_plans` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è
- `unique_patients` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
- `collection_rate` - –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–±–∏—Ä–∞–µ–º–æ—Å—Ç–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- `payment_statistics` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –æ–ø–ª–∞—Ç—ã

#### 2. **–û–±–Ω–æ–≤–ª–µ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ API** (`frontend/src/hooks/useCrmApi.js`)
```javascript
// –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã—Ä—É—á–∫–∏ –∏–∑ HMS
getHmsRevenueStatistics: useCallback(async () => {
  return await apiCall('GET', '/integration/hms-revenue-statistics');
}, [apiCall]),
```

#### 3. **–û–±–Ω–æ–≤–ª–µ–Ω CRM –¥–∞—à–±–æ—Ä–¥** (`frontend/src/components/crm/dashboard/CrmDashboard.js`)
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ HMS –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ **–†–µ–∞–ª—å–Ω–∞—è –≤—ã—Ä—É—á–∫–∞** –≤–º–µ—Å—Ç–æ –¥–∞–Ω–Ω—ã—Ö CRM
- ‚úÖ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞–Ω–æ–≤, —Å–æ–±–∏—Ä–∞–µ–º–æ—Å—Ç—å)
- ‚úÖ **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏** –¥–ª—è HMS –¥–∞–Ω–Ω—ã—Ö

### üìä –ù–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –¥–∞—à–±–æ—Ä–¥–µ:

#### –ë—ã–ª–æ:
```
–ö–ª–∏–µ–Ω—Ç—ã: 25
–ê–∫—Ç–∏–≤–Ω—ã–µ: 18 ‚Ä¢ VIP: 3
–í—ã—Ä—É—á–∫–∞: 12,811‚Ç∏ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è - –±–µ–∑ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤)
```

#### –°—Ç–∞–ª–æ:
```
–ö–ª–∏–µ–Ω—Ç—ã: 25
–ê–∫—Ç–∏–≤–Ω—ã–µ: 18 ‚Ä¢ VIP: 3
–í—ã—Ä—É—á–∫–∞ HMS: 17,811‚Ç∏ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è - –≤—Å–µ –ø–ª–∞–Ω—ã)
–ü–ª–∞–Ω–æ–≤: 13 ‚Ä¢ –°–æ–±–∏—Ä–∞–µ–º–æ—Å—Ç—å: 98.9%
```

### üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞—à–±–æ—Ä–¥–∞ CRM** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ HMS
2. **API —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ** –∏–∑ –í–°–ï–• –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è —á–µ—Ä–Ω–æ–≤–∏–∫–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è HMS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ)
3. **–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–∞—è –≤—ã—Ä—É—á–∫–∞** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—è `paid_amount` –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è
4. **–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏

### üí° –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:
- **–†–∞–Ω—å—à–µ**: `clientsStats.total_revenue` (–¥–∞–Ω–Ω—ã–µ CRM —Å–¥–µ–ª–æ–∫)
- **–¢–µ–ø–µ—Ä—å**: `hmsRevenueStats.total_revenue` (—Ä–µ–∞–ª—å–Ω—ã–µ –æ–ø–ª–∞—Ç—ã –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è HMS)

### üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ **–¢–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - —Ä–µ–∞–ª—å–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –∏–∑ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É—Å–ª—É–≥
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã
- ‚úÖ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** - –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–±–∏—Ä–∞–µ–º–æ—Å—Ç–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞–Ω–æ–≤
- ‚úÖ **–ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã** - –¥–∞–Ω–Ω—ã–µ –∏–∑ HMS –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

### üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `backend/crm/routes/integration.py` - –¥–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π endpoint
- `frontend/src/hooks/useCrmApi.js` - –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ API
- `frontend/src/components/crm/dashboard/CrmDashboard.js` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å HMS

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç:
–¢–µ–ø–µ—Ä—å –≤ –¥–∞—à–±–æ—Ä–¥–µ CRM –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è **—Ä–µ–∞–ª—å–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –∏–∑ –ø–ª–∞–Ω–æ–≤ –ª–µ—á–µ–Ω–∏—è HMS**, —á—Ç–æ –¥–∞–µ—Ç —Ç–æ—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–ª–∏–Ω–∏–∫–∏!
